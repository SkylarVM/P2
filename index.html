<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>ğŸ§ Penguin Companion â€” XP Planner</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="brand">
      <span class="brand-emoji">ğŸ§</span>
      <h1>Penguin Companion â€” XP Planner</h1>
    </div>
    <div class="stats">
      <span>Level <b id="level">1</b></span>
      <span>â€¢ XP <b id="exp">0.00</b></span>
      <span>â€¢ Coins <b id="coins">0</b></span>
    </div>
    <button id="openSettings" class="icon-btn" title="Settings">âš™ï¸</button>
  </header>
  <div class="progress"><div id="xpBar"></div></div>

  <main class="grid">
    <!-- Tasks -->
    <section class="card">
      <h2>âœ… Tasks</h2>
      <div class="row">
        <input id="taskName" placeholder="Task"/>
        <input id="taskXP" type="number" step="0.01" min="0.01" placeholder="XP"/>
        <select id="taskCat"></select>
        <button id="addTask">Add</button>
      </div>
      <div class="row"><button id="addCat" class="ghost">+ Category</button></div>
      <ul id="taskList" class="list"></ul>
    </section>

    <!-- Rewards -->
    <section class="card">
      <h2>ğŸ Rewards</h2>
      <div class="row">
        <input id="rewardName" placeholder="Reward"/>
        <input id="rewardCost" type="number" step="0.01" min="0.01" placeholder="Cost"/>
        <button id="addReward">Add</button>
      </div>
      <ul id="rewardList" class="list"></ul>
    </section>

    <!-- Stats -->
    <section class="card">
      <h2>ğŸ“Š Category Stats</h2>
      <div id="statsChart"></div>
    </section>

    <!-- Planner -->
    <section class="card wide">
      <h2>ğŸ“† Time-Blocking (15-min)</h2>
      <div class="row">
        <input id="schedTitle" placeholder="Block title"/>
        <input id="schedStart" type="time" step="900" value="08:00"/>
        <input id="schedEnd" type="time" step="900" value="09:00"/>
        <input id="schedColor" type="color" value="#60a5fa"/>
        <button id="addBlock">Add</button>
      </div>
      <div class="row">
        <button id="addFromTasks">ğŸ“‹ Add from Tasks</button>
        <button id="clearSchedule" class="ghost">ğŸ§¹ Clear Schedule</button>
        <button id="clearToday" class="ghost">ğŸ—‘ Clear Todayâ€™s History</button>
      </div>
      <div id="scheduleWrap">
        <div id="timeline">
          <div id="timeLabels"></div>
          <div id="eventLayer"></div>
          <div id="nowMarker"></div>
          <div id="nowPenguin">ğŸ§</div>
        </div>
      </div>
      <p class="muted">Click a block to edit.</p>
    </section>

    <!-- Avatar -->
    <section class="card">
      <h2>ğŸ§ My Penguin</h2>
      <div class="row center">
        <div id="avatarPreview" class="penguin">
          <div class="body"></div><div class="wing l"></div><div class="wing r"></div>
          <div class="eye l"></div><div class="eye r"></div><div class="beak"></div>
        </div>
        <div>Hi, Iâ€™m <b id="avatarName">Pingu</b>!</div>
      </div>
      <div class="row"><input id="avatarInputName" placeholder="Name (e.g., Penny)"/></div>
      <div class="row">
        <button class="chip" data-color="#0ea5e9">Blue</button>
        <button class="chip" data-color="#ef4444">Red</button>
        <button class="chip" data-color="#22c55e">Green</button>
        <button class="chip" data-color="#a855f7">Purple</button>
        <button class="chip" data-color="#f59e0b">Gold</button>
      </div>
      <div class="row">
        <select id="equipHead">
          <option value="">Head: none</option>
          <option value="cap">Cap</option><option value="crown">Crown</option>
          <option value="grad">Grad Hat</option><option value="headphones">Headphones</option><option value="glasses">Glasses</option>
        </select>
        <select id="equipBody">
          <option value="">Body: none</option>
          <option value="scarf">Scarf</option><option value="bow">Bow</option>
          <option value="cape">Cape</option><option value="mittens">Mittens</option>
        </select>
        <select id="equipEffect">
          <option value="">Effect: none</option>
          <option value="aura">Aura</option><option value="rainbow">Rainbow Aura</option><option value="frost">Frost Aura</option>
        </select>
      </div>
      <div class="row"><button id="saveAvatar">Save Avatar</button></div>
    </section>

    <!-- Shop -->
    <section class="card wide">
      <h2>ğŸ›ï¸ Penguin Shop</h2>
      <div id="shopGrid" class="shop"></div>
    </section>

    <!-- Pomodoro & Calls -->
    <section class="card">
      <h2>â±ï¸ Pomodoro & ğŸ“ Calls</h2>
      <div class="row wrap">
        <label>Focus <input id="focusInput" type="number" min="1" value="25"/></label>
        <label>Short <input id="breakInput" type="number" min="1" value="5"/></label>
        <label>Long <input id="longBreakInput" type="number" min="1" value="15"/></label>
        <button id="savePomo">Save</button>
      </div>
      <div class="row wrap">
        <button id="callChill">ğŸ¥ Call Penguin</button>
        <button class="ghost" data-call="Study">Study</button>
        <button class="ghost" data-call="Exercise">Exercise</button>
        <button class="ghost" data-call="Eat">Eat</button>
        <button class="ghost" data-call="Bath">Bath</button>
        <button class="ghost" data-call="Sleep">Sleep</button>
        <button class="ghost" id="openPomo">ğŸ… Open Pomodoro</button>
        <button class="ghost" id="shareMeet">ğŸ”— Share call (Meet)</button>
      </div>
      <p class="muted">Ambient Lab hum is muted by default. Toggle in overlays.</p>
    </section>

    <!-- Tools -->
    <section class="card">
      <h2>ğŸ§® & ğŸ” Tools</h2>
      <div class="row between">
        <button id="openCalcBtn">Open Calculator</button>
        <button id="openSearchBtn">Open Quick Search</button>
      </div>
    </section>

    <!-- Alarms -->
    <section class="card">
      <h2>â° Alarms</h2>
      <div class="row">
        <input id="alarmTime" type="time" step="60" value="08:00"/>
        <input id="alarmLabel" placeholder="Label"/>
        <select id="alarmTone">
          <option value="soft">Soft Digital</option>
          <option value="beep">Beep-Boop</option>
          <option value="ping">Pure Ping</option>
        </select>
        <button id="addAlarm">Add</button>
      </div>
      <ul id="alarmList" class="list"></ul>
    </section>

    <!-- History -->
    <section class="card wide">
      <h2>ğŸ“… History (Today)</h2>
      <div id="historySummary" class="muted">Total: 0 Pomodoros â€¢ 0 XP earned</div>
      <ul id="historyList" class="list"></ul>
    </section>

    <!-- Export/Import -->
    <section class="card wide">
      <h2>ğŸ’¾ Data â€” Export / Import</h2>
      <div class="row wrap">
        <button id="exportJSON">Export JSON</button>
        <button id="exportCSV" class="ghost">Export CSV</button>
        <input id="importFile" type="file" accept=".json,.csv" hidden/>
        <button id="importBtn">Import (JSON/CSV)</button>
        <label class="muted"><input id="overwriteImport" type="checkbox"/> Overwrite instead of merge</label>
      </div>
    </section>

    <!-- Race Mode -->
    <section class="card wide">
      <h2>ğŸ Race Mode (Multiplayer Pomodoro)</h2>
      <div class="row wrap">
        <button id="raceCreate">Create Race</button>
        <input id="raceCodeJoin" placeholder="Enter codeâ€¦"/>
        <button id="raceJoin">Join Race</button>
        <span id="raceCodeShow" class="badge"></span>
      </div>
      <div id="raceArea" class="race-area">
        <div class="row wrap">
          <button id="raceStartPomo">Start Shared Pomodoro</button>
          <button id="raceLeave" class="ghost">Leave</button>
        </div>
        <div class="row">
          <select id="raceMyTask"></select>
          <button id="raceMarkDone">Mark my task done</button>
        </div>
        <div id="raceTimer" class="race-timer">--:--</div>
        <div id="raceBoard" class="race-board"></div>
        <div id="racePodium" class="podium hidden"></div>
      </div>
    </section>
  </main>

  <!-- Edit Block Modal -->
  <div id="editModal" class="modal">
    <div class="box">
      <h3>Edit Block</h3>
      <input id="mTitle" placeholder="Title"/>
      <div class="row">
        <label>Start <input id="mStart" type="time" step="900"/></label>
        <label>End <input id="mEnd" type="time" step="900"/></label>
      </div>
      <label>Color <input id="mColor" type="color"/></label>
      <div class="row">
        <button id="mSave">Save</button>
        <button id="mDelete" class="danger">Delete</button>
        <button id="mCancel" class="ghost">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Pomodoro Overlay -->
  <div id="pomoOverlay" class="overlay">
    <div class="panel">
      <div class="panel-head">
        <div id="pomoTitle">ğŸ… Pomodoro</div>
        <div class="row">
          <label class="muted">ğŸ”Š Ambient <input id="ambientToggle" type="checkbox"/></label>
          <input id="ambientVol" type="range" min="0" max="100" value="40"/>
          <button id="pomoClose" class="ghost">âœ– Close</button>
        </div>
      </div>
      <div id="scenePomo" class="scene"></div>
      <div id="pomoPhase" class="muted">Focus</div>
      <div id="focusCircle" class="ball"></div>
      <div id="breakCircle" class="ball hide"></div>
      <div id="pomoTimer" class="big">25:00</div>
      <div class="row">
        <button id="pomoPause" class="warn">â¸ï¸ Pause</button>
        <button id="pomoDone" class="ok">âœ… Done</button>
        <button id="pomoExit" class="danger">âŒ Exit</button>
      </div>
    </div>
  </div>

  <!-- Calls Overlay / Floating -->
  <div id="callOverlay" class="overlay">
    <div class="panel">
      <div class="panel-head">
        <div id="callTitle">ğŸ“ Penguin Call</div>
        <div class="row">
          <label class="muted">ğŸ”Š Ambient <input id="callAmbToggle" type="checkbox"/></label>
          <input id="callAmbVol" type="range" min="0" max="100" value="40"/>
          <button id="callMin" class="ghost">â– Minimize</button>
          <button id="callClose" class="ghost">âœ– Close</button>
        </div>
      </div>
      <div id="sceneCall" class="scene"></div>
      <div id="callTiny" class="muted hide">Pomodoro: --:-- left</div>
    </div>
  </div>

  <div id="callFloat" class="call-float">
    <div class="float-head">
      <span>ğŸ“ Penguin Call</span>
      <div>
        <button id="floatRestore" class="ghost">â›¶</button>
        <button id="floatClose" class="ghost">âœ–</button>
      </div>
    </div>
    <div class="float-body">
      <div id="floatPenguin" class="penguin small">
        <div class="body"></div><div class="wing l"></div><div class="wing r"></div>
        <div class="eye l"></div><div class="eye r"></div><div class="beak"></div>
      </div>
      <div id="floatCaption" class="muted">Chillingâ€¦</div>
      <div id="floatTiny" class="muted hide">Pomodoro: --:-- left</div>
    </div>
  </div>

  <!-- Calculator Modal -->
  <div id="calcModal" class="modal">
    <div class="box">
      <h3>Calculator</h3>
      <input id="calcDisplay" readonly/>
      <div id="calcGrid" class="calc-grid"></div>
      <div class="row"><button id="calcClose" class="ghost">Close</button></div>
    </div>
  </div>

  <!-- Search Modal -->
  <div id="searchModal" class="modal">
    <div class="box large">
      <h3>Quick Search</h3>
      <div class="row">
        <input id="searchInput" placeholder="Search definitionsâ€¦"/>
        <button id="searchGo">Search</button>
      </div>
      <iframe id="searchFrame" title="Search"></iframe>
      <div class="row"><button id="searchClose" class="ghost">Close</button></div>
    </div>
  </div>

  <!-- Alarm Popup -->
  <div id="alarmPopup" class="modal">
    <div class="box">
      <h3>â° Alarm</h3>
      <div id="alarmMsg">Time!</div>
      <div class="row">
        <button id="alarmSnooze">Snooze 5 min</button>
        <button id="alarmOk" class="ok">OK</button>
      </div>
    </div>
  </div>

  <!-- Settings (sidebar) -->
  <aside id="settings" class="settings">
    <div class="settings-head">
      <h3>âš™ï¸ Settings</h3>
      <button id="closeSettings" class="ghost">âœ–</button>
    </div>
    <div class="muted">Saved automatically</div>
    <hr/>
    <div class="set">
      <label>Theme</label>
      <select id="setTheme">
        <option value="tech">ğŸ’» Tech Lab</option>
        <option value="arctic">â„ï¸ Arctic Base</option>
        <option value="sunset">ğŸŒ… Sunset Beach</option>
        <option value="space">ğŸŒŒ Space Nebula</option>
      </select>
    </div>
    <div class="set">
      <label>Language</label>
      <select id="setLang">
        <option value="en">English</option>
        <option value="es">EspaÃ±ol</option>
      </select>
    </div>
    <div class="set">
      <label>Default Alarm/Pomodoro Sound</label>
      <select id="setSound">
        <option value="soft">Soft Digital</option>
        <option value="beep">Beep-Boop</option>
        <option value="ping">Pure Ping</option>
      </select>
    </div>
    <div class="set">
      <label>Global Volume</label>
      <input id="setVol" type="range" min="0" max="100" value="40"/>
    </div>
    <hr/>
    <h4>Avatar</h4>
    <div class="avatar-row">
      <div id="settingsAvatar" class="penguin">
        <div class="body"></div><div class="wing l"></div><div class="wing r"></div>
        <div class="eye l"></div><div class="eye r"></div><div class="beak"></div>
      </div>
      <div class="stack">
        <input id="sName" placeholder="Name"/>
        <div class="row">
          <input id="sColor" type="color" value="#0ea5e9"/>
          <select id="sHead">
            <option value="">Head: none</option>
            <option value="cap">Cap</option><option value="crown">Crown</option><option value="grad">Grad Hat</option><option value="headphones">Headphones</option><option value="glasses">Glasses</option>
          </select>
        </div>
        <div class="row">
          <select id="sBody">
            <option value="">Body: none</option>
            <option value="scarf">Scarf</option><option value="bow">Bow</option><option value="cape">Cape</option><option value="mittens">Mittens</option>
          </select>
          <select id="sEffect">
            <option value="">Effect: none</option>
            <option value="aura">Aura</option><option value="rainbow">Rainbow Aura</option><option value="frost">Frost Aura</option>
          </select>
        </div>
        <button id="sSave">Save avatar</button>
      </div>
    </div>
    <hr/>
    <div class="row">
      <button id="recalcEconomy" class="ghost">ğŸª™ Recalculate XP/Coins</button>
      <button id="resetTodayBtn" class="ghost">Reset Today</button>
      <button id="clearAllBtn" class="danger">Clear All</button>
    </div>
  </aside>

  <script src="script.js"></script>
</body>
</html>

/* ============== Base ============== */
:root{
  --bg:#0f1824;
  --bg-soft:#121e2d;
  --card:#122033;
  --card-2:#0f1b2b;
  --muted:#9fb3d1b8;
  --text:#e9f0ff;
  --title:#95b7ff;
  --brand:#4f83ff;
  --brand-2:#3767ff;
  --ok:#20c997;
  --warn:#ffcc00;
  --danger:#ef4444;
  --barWarm: linear-gradient(90deg,#ff4d4d,#ff9a2f);
  --barGreen: linear-gradient(90deg,#95ff36,#39e26a);
  --barCyan: linear-gradient(90deg,#7be9ff,#22c1ff);
  --barPurple: linear-gradient(90deg,#b280ff,#6a65ff);
  --ring: rgba(79,131,255,.35);
  --shadow: 0 10px 30px rgba(0,0,0,.35);
  --radius: 16px;
  --radius-lg: 22px;
  --blur: saturate(120%) blur(0.6px);
}

*{box-sizing:border-box}
html,body{margin:0;height:100%}
body{
  font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background: radial-gradient(1000px 700px at 80% -20%,#1a2e4f2e,transparent) , var(--bg);
  color:var(--text);
}

/* ============== Header ============== */
.app-header{
  max-width:1200px;margin:28px auto 10px; padding:10px 20px 0;
  text-align:center;
}
.brand{display:flex;gap:12px;align-items:center;justify-content:center}
.brand .logo{font-size:32px;filter:drop-shadow(0 4px 6px rgba(0,0,0,.3))}
.app-header h1{margin:6px 0 8px;font-weight:800;letter-spacing:.3px}
.stats-line{opacity:.9;margin-bottom:8px}
.xp-track{height:14px;background:#22324b;border-radius:999px;overflow:hidden;box-shadow:inset 0 2px 6px rgba(0,0,0,.35)}
.xp-fill{height:100%;background:linear-gradient(90deg,#5aa2ff,#3b82f6,#5aa2ff);transition:width .6s ease;filter:saturate(120%)}
.header-actions{display:flex;gap:8px;justify-content:center;margin-top:14px}
.icon-btn{background:#1b2a44;color:#cfe0ff;border:none;border-radius:12px;padding:8px 10px;font-size:18px;cursor:pointer}
.ghost{background:#1b2a44;border:1px solid #2a3d63;color:#dbe8ff;border-radius:12px;padding:8px 12px;cursor:pointer}
.ghost.danger{border-color:#532b2b;color:#ffb2b2;background:#2a1616}

/* ============== Grid & Cards ============== */
.grid{
  max-width:1200px;margin:0 auto 80px;display:grid;gap:18px;
  grid-template-columns:repeat(3,1fr);
  padding:0 16px;
}
.card{
  background:linear-gradient(180deg,#101c2d 0%,#0e1a2a 100%);
  border-radius:var(--radius-lg); padding:18px 18px 16px;
  box-shadow: var(--shadow);
  border:1px solid #22324b;
}
.span-2{grid-column:span 2}
.card-title{font-weight:800;font-size:22px;margin-bottom:14px;display:flex;gap:10px;align-items:center}
.row{display:flex;gap:12px;align-items:center}
.row.wrap{flex-wrap:wrap}
.row.gap{gap:14px}
.inputs{margin-bottom:12px}
.muted{color:var(--muted);margin-top:8px}

/* ============== Forms & Buttons ============== */
.input,.select,button{
  font:inherit;color:var(--text);
}
.input,.select{
  background:#09131f;border:1px solid #243651;color:#e9f1ff;
  padding:10px 12px;border-radius:12px;outline:0;min-height:42px;
}
.input.small{min-width:110px}
.input.xs{min-width:70px}
.input.flex{flex:1}
.input.color{padding:4px}
.select{min-width:160px}

.primary{
  background:linear-gradient(180deg,#4f83ff,#3767ff);
  border:none;color:white;border-radius:12px;padding:10px 16px;cursor:pointer;
  box-shadow:0 6px 16px rgba(79,131,255,.35);
}
.primary:active{transform:translateY(1px)}
.chip{
  background:#15233a;border:1px solid #29436a;color:#cfe1ff;padding:8px 14px;border-radius:999px;cursor:pointer
}
.chip.tomato{background:#1f1a28;border-color:#52306b}
.chip.meet{background:#182733;border-color:#27475f}

/* ============== Lists ============== */
.list{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:10px}
.list .item{
  background:#0f1b2b;border:1px solid #233550;border-radius:14px;
  padding:14px;display:flex;justify-content:space-between;align-items:flex-start;gap:12px;
}
.item .meta{font-size:13px;color:#a8bedc;margin-top:4px}
.item .left b{display:block;margin-bottom:2px}

/* Task action buttons */
.btn-row{display:flex;gap:10px;align-items:center}
.btn-focus{background:#2b57ff;border:none;color:#fff;padding:10px 16px;border-radius:14px;box-shadow:0 6px 16px rgba(59,130,246,.35);cursor:pointer}
.btn-done{background:#17301e;border:1px solid #2b7a4b;color:#adf3d0;border-radius:12px;padding:9px 12px;cursor:pointer}
.btn-del{background:#2b1616;border:1px solid #5c2a2a;color:#ffb2b2;border-radius:12px;padding:9px 12px;cursor:pointer}

/* ============== Stats Bars ============== */
.stat-row{margin:10px 0}
.stat-label{margin:6px 2px 8px}
.bar{height:18px;background:#0a1421;border-radius:999px;overflow:hidden;border:1px solid #22324b}
.bar-fill{height:100%;width:0%;transition:width .6s ease, filter .3s ease;border-radius:999px}
.grad-warm{background:var(--barWarm)}
.grad-green{background:var(--barGreen)}
.grad-cyan{background:var(--barCyan)}
.grad-purple{background:var(--barPurple)}

/* ============== Overlays & Modals ============== */
.overlay{
  position:fixed;inset:0;backdrop-filter: blur(6px); display:flex;
  align-items:center;justify-content:center;z-index:30;
}
.overlay.hidden{display:none}
.overlay-card{
  width:min(900px,92vw);background:linear-gradient(180deg,#0e1928,#0a1522);
  border:1px solid #233650;border-radius:22px;box-shadow:0 32px 80px rgba(0,0,0,.55);
}
.overlay-head{
  padding:14px 16px;border-bottom:1px solid #1f2d44;display:flex;align-items:center;justify-content:space-between
}
.overlay-head .title{font-weight:700}
.overlay-head .ambient{display:flex;align-items:center;gap:10px;color:#b8c8e3}
.danger{color:#ffb4b4}
.call-card{padding-bottom:10px}

/* Pomodoro overlay content */
.pomo-body{display:flex;align-items:center;justify-content:center;padding:26px}
.pomo-circle{
  width:240px;height:240px;border-radius:50%;
  background: radial-gradient(70% 70% at 50% 35%, #5aa2ff 0%, #3767ff 70%, #1d2c4f 110%);
  display:flex;align-items:center;justify-content:center;
  box-shadow: inset 0 -20px 40px rgba(0,0,0,.35), 0 16px 40px rgba(0,0,0,.35);
}
.pomo-time{font-weight:800;font-size:42px}
.pomo-actions{display:flex;gap:10px;justify-content:center;padding:0 0 20px}
.success{background:#186a44;color:#d9ffe9;border:none;border-radius:12px;padding:10px 14px}
.pomo-micro{
  position:fixed;right:22px;bottom:22px;background:#06111d;border:1px solid #27405f;color:#9fd1ff;
  padding:8px 12px;border-radius:10px;box-shadow:var(--shadow)
}
.hidden{display:none}

/* ============== Call overlay (3D penguin) ============== */
.call-stage{position:relative;height:min(62vh,520px);padding:16px}
.backdrop{
  position:absolute;inset:16px;border-radius:18px;filter:blur(.2px) saturate(120%);
  background: radial-gradient(600px 360px at 50% 40%, #1a2d46 0%, #0c1522 65%, #06101a 100%);
  border:1px solid #1e2b40;box-shadow:inset 0 18px 60px rgba(255,255,255,.03), inset 0 -30px 90px rgba(0,0,0,.6);
}
.backdrop.tech::after{
  content:""; position:absolute; inset:0; border-radius:inherit; pointer-events:none;
  background:
    radial-gradient(500px 320px at 60% -40%, rgba(66,166,255,.15), transparent 60%),
    linear-gradient(115deg, transparent 0 40%, rgba(90,170,255,.08) 42%, transparent 46%),
    repeating-linear-gradient(115deg, rgba(94,178,255,.07) 0 2px, transparent 2px 32px);
}
.penguin{
  position:absolute; inset:0; display:grid; place-items:center;
}
.penguin .pg-body{
  width:200px;height:200px;border-radius:45% 45% 48% 48%;
  background: radial-gradient(120px 120px at 50% 40%, #ffffff 0 60%, #ffffffd8 62% 100%),
              radial-gradient(180px 150px at 50% 70%, #8155ff 0%, #6b3eff 45%, #4e2fd6 85%);
  box-shadow: 0 16px 40px rgba(0,0,0,.35);
}
.penguin .pg-face{
  position:absolute;width:200px;height:200px;border-radius:45%;
  box-shadow: inset 0 -18px 30px rgba(0,0,0,.15);
}
.pg-eye{width:14px;height:14px;background:#0c0c0c;border-radius:50%;position:absolute;top:calc(50% - 18px)}
.pg-eye.l{left:calc(50% - 26px)}
.pg-eye.r{right:calc(50% - 26px)}
.pg-beak{
  position:absolute;top:calc(50% + 2px);left:50%;transform:translateX(-50%);
  width:44px;height:18px;border-radius:10px;background:linear-gradient(180deg,#ffc154,#ff941f)
}
/* props/animations */
.prop{position:absolute;opacity:0;transition:opacity .25s ease}
.prop-pen{width:170px;height:8px;border-radius:8px;background:#1a7ea4;top:55%;left:calc(50% - 85px)}
.prop-bar{width:110px;height:14px;border-radius:7px;background:#a9b1bb;top:62%;left:calc(50% - 55px)}
.prop-spoon{width:72px;height:8px;border-radius:6px;background:#c1c5cc;top:66%;left:calc(50% - 36px)}
.prop-bath{width:140px;height:28px;border-radius:14px;background:linear-gradient(180deg,#dff5ff,#bfe7ff);top:70%;left:calc(50% - 70px)}
.prop-zzz{top:42%;left:62%;color:#b6c2ff;font-weight:800;font-size:28px}
.call-mini{
  position:fixed;right:18px;bottom:18px;background:#0a1421;border:1px solid #20324b;border-radius:16px;
  display:flex;gap:10px;align-items:center;padding:10px 12px;box-shadow:var(--shadow)
}
.call-mini .mini-penguin{width:28px;height:28px;border-radius:50%;background:radial-gradient(14px 14px at 50% 40%, #fff 0 60%, #fff0 62%), radial-gradient(28px 24px at 50% 70%, #8155ff, #4e2fd6)}
.call-mini .mini-text{color:#cfe1ff;max-width:180px}
.mini-btn{background:#172439;border:1px solid #2a4368;color:#cfe1ff;border-radius:10px;padding:6px 8px;margin-left:8px}
.mini-btn.danger{border-color:#5c2a2a;color:#ffb2b2;background:#2a1616}

/* ============== Modals ============== */
.modal{position:fixed;inset:0;background:rgba(4,10,18,.55);backdrop-filter:blur(4px);display:none;align-items:center;justify-content:center;z-index:40}
.modal.show{display:flex}
.modal-card{
  width:min(900px,92vw);background:#0c1726;border:1px solid #243651;border-radius:18px;box-shadow:var(--shadow);
}
.modal-head{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid #21314a}
#calcFrame,#searchFrame{width:100%;height:68vh;border:0;border-radius:0 0 18px 18px;background:#09131f}
.search-row{padding:10px 14px;border-bottom:1px solid #1c2a41}

/* ============== Settings Sidebar ============== */
.settings{
  position:fixed;top:0;right:-420px;width:380px;height:100%;z-index:50;
  background:#0c1726;border-left:1px solid #243651;box-shadow:-18px 0 60px rgba(0,0,0,.45);
  transition:right .35s ease; padding-bottom:20px; overflow:auto;
}
.settings.show{right:0}
.settings-head{position:sticky;top:0;background:#0c1726;z-index:1;border-bottom:1px solid #21314a;padding:12px 14px;display:flex;justify-content:space-between;align-items:center}
.settings .title{font-weight:800}
.settings-section{padding:14px;border-bottom:1px solid #152236}
.settings-section .subtitle{font-weight:700;margin-bottom:12px}
.settings-avatar{width:140px;height:140px;margin:8px auto 10px;position:relative;border-radius:50%;
  background: radial-gradient(40px 40px at 50% 35%, #fff 0 60%, #ffffffd8 62% 100%),
              radial-gradient(100px 90px at 50% 70%, #8155ff 0%, #6b3eff 45%, #4e2fd6 85%);
  box-shadow:0 16px 40px rgba(0,0,0,.35)
}
.settings .danger-zone{display:grid;gap:10px}

/* ============== Schedule ============== */
.schedule{position:relative;margin-top:14px;border:1px solid #22324b;border-radius:16px;background:#0a1421;height:560px;overflow:auto}
.schedule-grid{position:relative;min-height:1440px; /* 24h x 60 */ }
.schedule-grid::before{
  content:"";position:absolute;inset:0;background:
   repeating-linear-gradient(#0, #0 0),
   repeating-linear-gradient(0deg, transparent 0 28px, rgba(255,255,255,.04) 28px 29px);
}
.now-marker{position:absolute;left:8px;top:0;transform:translateY(-50%);filter:drop-shadow(0 6px 14px rgba(0,0,0,.4))}
.block{
  position:absolute;left:70px;right:10px;border-radius:10px;padding:6px 10px;color:#07121c;font-weight:600;box-shadow:0 8px 20px rgba(0,0,0,.4);
  border:1px solid #0003
}
.block .t{opacity:.7;font-weight:500}
.block .edit{float:right;background:#0c1726;border:1px solid #243651;color:#cfe1ff;border-radius:8px;padding:4px 8px;cursor:pointer}

/* ============== Shop ============== */
.shop-stats{color:#b9c8e2;margin-bottom:10px}
.shop-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px}
.items{display:grid;grid-template-columns:repeat(2,minmax(160px,1fr));gap:12px}
.tile{
  background:#0d1928;border:1px solid #22324b;border-radius:14px;padding:12px;box-shadow:0 10px 24px rgba(0,0,0,.35);
}
.tile .thumb{
  height:90px;border-radius:10px;background:radial-gradient(120px 80px at 50% 60%, #8155ff 0%, #4e2fd6 80%);margin-bottom:10px;
}
.tile .row{justify-content:space-between}
.tile .buy{background:#2b57ff;border:none;color:#fff;border-radius:10px;padding:8px 12px;cursor:pointer}
.badge{display:inline-block;background:#1b2a44;border:1px solid #2a3d63;padding:4px 8px;border-radius:999px;color:#cfe1ff;font-size:12px}

/* ============== Race (Kahoot-like full-screen) ============== */
.race{position:fixed;inset:0;background:#081221;z-index:60;display:none}
.race.show{display:block}
.race-stage{height:100%;display:grid;grid-template-rows:auto 1fr}
.race-head{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid #1e2b3a;background:#0c1627}
.race-brand{font-weight:800;font-size:20px}
.race-content{display:grid;place-items:center;height:100%}
.race-panel{
  width:min(900px,92vw);background:linear-gradient(180deg,#0c1726,#0a1421);border:1px solid #22324b;
  border-radius:22px;box-shadow:0 28px 70px rgba(0,0,0,.55); padding:18px;
  text-align:center
}
.race-code{font-size:52px;font-weight:800;letter-spacing:2px;background:#0a1421;border:1px dashed #2a3d63;padding:8px 14px;border-radius:12px;display:inline-block}
.race-participants{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin:12px 0}
.part-chip{background:#15233a;border:1px solid #29436a;color:#cfe1ff;padding:8px 12px;border-radius:999px}
.race-actions .ghost{margin-left:10px}

/* ============== Helpers ============== */
.inline{display:flex;align-items:center;gap:8px}
.dash{opacity:.5}
.flex{flex:1}

/* ============== Responsive ============== */
@media (max-width:980px){
  .grid{grid-template-columns:1fr}
  .span-2{grid-column:1}
  .shop-grid{grid-template-columns:1fr}
  .items{grid-template-columns:repeat(2,1fr)}
}

@media (max-width:520px){
  .items{grid-template-columns:1fr}
  .overlay-card{width:94vw}
  .settings{width:92vw}
}
